# XQuant Colorimetric - ฟีเจอร์การบันทึกข้อมูล

## ฟีเจอร์ใหม่ที่เพิ่มเข้ามา

### 1. การบันทึกลง Local Cache (เครื่อง)
- **ตำแหน่ง**: ปุ่ม "บันทึกลงเครื่อง" ในส่วน Save Options
- **การทำงาน**: บันทึกข้อมูลลง localStorage ของเบราว์เซอร์
- **ความถาวร**: ข้อมูลจะคงอยู่จนกว่าผู้ใช้จะลบ cache เอง
- **ไม่ต้องใช้รหัสผ่าน**: บันทึกได้ทันที

### 2. การบันทึกลง Server (พร้อมรหัสผ่าน)
- **ตำแหน่ง**: ปุ่ม "บันทึกลง Server" ในส่วน Save Options
- **การทำงาน**: 
  - ก่อนบันทึกจะแสดง Modal ให้ใส่รหัสผ่าน
  - รหัสผ่านเริ่มต้น: `xquant2024` (สามารถเปลี่ยนได้ในโค้ด)
  - ข้อมูลจะถูกส่งไปยัง Server API
  - หาก Server ไม่พร้อมใช้งาน จะบันทึกลง Local Backup
- **การเข้าถึง**: ทุกคนสามารถดูข้อมูลได้ แต่บันทึกได้เฉพาะผู้มีรหัสผ่าน

### 3. การบันทึกแบบ Session Cache (ชั่วคราว)
- **ตำแหน่ง**: ปุ่ม "บันทึกชั่วคราว" ในส่วน Save Options
- **การทำงาน**: บันทึกข้อมูลลง sessionStorage
- **ความถาวร**: ข้อมูลจะหายเมื่อปิดแท็บหรือเบราว์เซอร์

### 4. หน้าแสดงรายการ (List Page)
- **การเข้าถึง**: ปุ่ม "View Saved List" ในส่วน Save Best Regression
- **โหมดการแสดง**:
  - **ข้อมูลในเครื่อง**: แสดงข้อมูลจาก Local + Session Storage
  - **ข้อมูลบน Server**: แสดงข้อมูลจาก Server API
- **ฟีเจอร์**: 
  - แสดงรายการข้อมูลที่บันทึกไว้
  - กดปุ่ม "โหลด" เพื่อนำข้อมูลกลับมาใช้งาน
  - แสดงสถานะแหล่งที่มาของข้อมูล (เครื่อง/ชั่วคราว/Server)

## การใช้งาน

### การบันทึกข้อมูล
1. สร้างข้อมูลตัวอย่างและทำการวิเคราะห์ Regression
2. ไปที่ส่วน "5. Save Best Regression"
3. เลือกวิธีการบันทึกที่ต้องการ:
   - **บันทึกลงเครื่อง**: คลิกปุ่ม "บันทึกลงเครื่อง"
   - **บันทึกลง Server**: คลิกปุ่ม "บันทึกลง Server" และใส่รหัสผ่าน
   - **บันทึกชั่วคราว**: คลิกปุ่ม "บันทึกชั่วคราว"

### การดูรายการข้อมูล
1. คลิกปุ่ม "View Saved List"
2. เลือกโหมดการแสดง:
   - **ข้อมูลในเครื่อง**: ดูข้อมูลที่บันทึกในเครื่อง
   - **ข้อมูลบน Server**: ดูข้อมูลที่บันทึกบน Server
3. คลิกปุ่ม "โหลด" เพื่อนำข้อมูลกลับมาใช้งาน

## การตั้งค่า Server

### API Endpoints ที่ต้องมี
```javascript
// บันทึกข้อมูล
POST /api/save-regression
Headers: {
  'Content-Type': 'application/json',
  'Authorization': 'Bearer {password}'
}
Body: regressionData

// ดึงข้อมูล
GET /api/get-regressions
Response: Array of regression data
```

### การเปลี่ยนรหัสผ่าน
แก้ไขในไฟล์ `script.js` บรรทัดที่ 1050:
```javascript
if (password === 'xquant2024') { // เปลี่ยนรหัสผ่านตรงนี้
```

## โครงสร้างข้อมูลที่บันทึก

```javascript
{
  id: "unique_id",
  timestamp: "2024-01-01T00:00:00.000Z",
  name: "Absorbance (R)",
  rSquared: 0.9876,
  rmse: 0.0123,
  equation: {
    slope: 0.1234,
    intercept: 0.5678
  },
  blankReference: {
    id: "blank_id",
    rgb: { r: 255, g: 255, b: 255 },
    color: "rgb(255,255,255)"
  },
  extinctionCoeff: 1234.56,
  pathLength: 1.0,
  xAxisType: "C",
  samples: [...],
  saveType: "local|session|server",
  saveTime: "2024-01-01T00:00:00.000Z"
}
```

## หมายเหตุ

- ข้อมูลจะถูกบันทึกในรูปแบบ JSON
- Local Storage มีขนาดจำกัด (ประมาณ 5-10 MB)
- Session Storage จะหายเมื่อปิดเบราว์เซอร์
- Server API ควรมีการตรวจสอบรหัสผ่านที่ปลอดภัย
- หาก Server ไม่พร้อมใช้งาน ระบบจะใช้ Local Backup เป็น fallback
